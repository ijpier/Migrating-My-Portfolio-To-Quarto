---
title: "Florida Crime Analytics"
---

# Exploring Crime in Florida

My company has chosen me to investigate and uncover what socioeconomic factors are most strongly associated with rising crime rates across Florida counties. I'm super excited!

## Loading and Preparing the Data

Now I'm going to load and clean the data.

```{r}
#| label: loading-library-and-dataset
#| message: false
#| warning: true
#| paged-print : false

library(readxl)
florida_crime <- read_excel("data/Florida County Crime Rates.xlsx")
head(florida_crime)
```

### Renaming columns and formatting county names

```{r}
#| label: renaming-columns
#| message: false
#| warning: true
#| paged-print : false

library(tidyverse)
florida_crime <- florida_crime %>%
  rename(
    Crime = "C",
    Income = "I",
    HighSchoolGrad = "HS",
    UrbanPop = "U"
  )
florida_crime
```

```{r}
#| label: loading-libraries-to-mutate-dataset
#| message: false
#| warning: true
#| paged-print : false

library(tidyverse)
library(skimr)
florida_crime <- florida_crime %>%
  mutate (County = str_to_title(County))
florida_crime
skim(florida_crime)
summary(florida_crime)
```

## Exploratory Data Analysis

Descriptive statistics for florida_crime.

```{r}
summary(florida_crime)
```

By using the summary function (twice) we can take a look at the mean, median, and range of the dataset.

Mean Crime = 52.4, Mean Income = 24.15, Mean HighSchoolGrad = 69.49, Mean UrbanPop = 49.56 Median Crime = 52, Median Income = 24.60, Median HighSchoolGrad = 69, Median UrbanPop = 44.60 Range Crime = 0-128, Range Income = 15.40-35.60, Range HighSchoolGrad = 54.50-84.90, Range UrbanPop = 0-99.60

## Visualizing the data in all its glory

```{r}
#| label: fig-crime-by-income
#| message: false
#| warning: true
#| fig-cap: This graph how crime varies by income.
#| fig-alt: This graph how crime varies by income.
#| paged-print : false

viz1 <- ggplot(florida_crime, aes(x=Income, y=Crime))+
  geom_point(size=2.5)+
  geom_smooth(method = "lm", se=FALSE)+
  labs(
    title = "Income vs Crime",
    x = "Income",
    y = "Crime"
  )
print(viz1)
```

Looking at the slope line, the graph shows that as Income increases Crime also increases.

```{r}
#| label: fig-crime-by-education
#| message: false
#| warning: true
#| fig-cap: This graph shows hows crime varies by education.
#| fig-alt: This graph shows hows crime varies by education.
#| paged-print : false


viz2 <- ggplot(florida_crime, aes(x=HighSchoolGrad, y=Crime))+
  geom_point(size=2.5)+
  geom_smooth(method = "lm", se=FALSE)+
  labs(
    title = "School vs Crime",
    x = "School",
    y = "Crime"
  )
print(viz2)
```

Here we also see a similar trend from the previous graph. As school graduation increases so does Crime.

```{r}
#| label: fig-crime-by-population
#| message: false
#| warning: true
#| fig-cap: This graph shows how crime varies by population.
#| fig-alt: This graph shows how crime varies by population


viz3 <- ggplot(florida_crime, aes(x=UrbanPop, y=Crime))+
  geom_point(size=2.5)+
  geom_smooth(method = "lm", se=FALSE)+
  labs(
    title = "Urban Lifestyle vs Crime",
    x = "UrbanPop",
    y = "Crime"
  )
print(viz3)
```

Again, there is a similar pattern as the two previous graphs. As the percentage of the urban population increases so does Crime.

Let's use patchwork for better readability.

```{r}
#| label: fig-side-by-side-scatterplots
#| message: false
#| warning: true
#| fig-cap: Side-by-side comparison of the three scatterplots.
#| fig-alt: Side-by-side comparison of the three scatterplots.

library(patchwork)
viz1+viz2+viz3
```

## Correlation Analysis

```{r}
#| label: making-dataset-into-numeric
#| message: false
#| warning: true
#| paged-print : false

library(tidyverse)
Numeric_florida_crime <- florida_crime %>% 
  dplyr::select(Crime, Income, HighSchoolGrad, UrbanPop)
head(Numeric_florida_crime)
```

```{r}
#| label: running-correlation
#| message: false
#| warning: true
#| paged-print : false

library(Hmisc)
Cor_Max <- rcorr(as.matrix(Numeric_florida_crime))
Cor_Max
```

There is a positive correlation between Income and Crime r = 0.43 There is a positive correlation between HighSchoolGrad and Crime r= 0.47. There is a positive correlation between UrbanPop and Crime r = 0.68 (the strongest correlation among the variables).

## Building Regression Models

```{r}
m1 <- lm(Crime ~ Income, data = Numeric_florida_crime)
summary(m1)
AIC(m1)
```

```{r}
m2 <- lm(Crime ~ HighSchoolGrad, data = Numeric_florida_crime)
summary(m2)
AIC(m2)
```

```{r}
m3 <- lm(Crime ~ UrbanPop, data = Numeric_florida_crime)
summary(m3)
AIC(m3)
```

## Multiple regression models

```{r}
m4 <- lm(Crime ~ Income + UrbanPop, data = Numeric_florida_crime)
summary(m4)
AIC(m4)
```

```{r}
m5 <- lm(Crime ~ Income + HighSchoolGrad, data = Numeric_florida_crime)
summary(m5)
AIC(m5)
```

```{r}
m6 <- lm(Crime ~ Income + UrbanPop + HighSchoolGrad, data = Numeric_florida_crime)
summary(m6)
AIC(m6)
```

## Comparing models

m1, R-squared of 0.188, Adjusted R-squared of 0.176, and AIC \[628.6045\] (variance explained is 18%).

m2, R-squared of 0.218, Adjusted R-squared of 0.206, and AIC \[626.0932\] (variance explained is 21%).

m3, R-squared of 0.459, Adjusted R-squared of 0.451, and AIC \[601.43\] (variance explained is 45%).

m4, R-squared of 0.467, Adjusted R-squared of 0.451, and AIC \[602.4276\] (variance explained is 45%).

m5, R-squared of 0.229, Adjusted R-squared of 0.205, and AIC \[627.1524\] (variance explained is 20%).

m6, R-squared of 0.473, Adjusted R-squared of 0.447, and AIC \[603.6764\] (variance explained is 45%).

## Reflections

I can see that m3, m4, and m6 have the highest R-squared and Adjusted R-squared compared to m1,m2, and m5. Also, m3 has the lowest AIC which makes this model less complex when explaining the variance between the variables. I can also see that m4 and m6 have the lowest AIC following m3. m3 is more balance when it comes to R-squared and Adjusted R-squared. It's safe to say that m3 is the best model for accuracy and simplicity.

## Conclusion

After cleaning and analyzing the data by comparing different models for better crime predictions, I am confident about recommending model 3 (Crime and Urban Population) as it the most influential predictor when it comes to crime. This model explains 45% of the variance between the dependent variable (Crime) and the independent variable (UrbanPop). The PD should focus on highly populated areas to provide a sense of security to the population, which can help reduce the possibilities of committing crimes. One limitation is that correlation is not causation, and besides we don't really have much data to look into age as a potential variable to understand what age groups are more likely to engage in such activities and devise better plans for interventions.
