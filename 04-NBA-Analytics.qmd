---
title: "NBA Analytics - Exploring Team Performance Through Reproducible Analysis"
---

## NBA Analytics

Here, I investigate different teams in the NBA by looking at their stats for the regular season.

## Loading and Preparing the Data

```{r}
#| label: loading-the-dataset
#| message: false
#| warning: true
#| paged-print : false

library(readxl)
team <- read_excel("data/NBA Team Total Data 2024-2025.xlsx", sheet = 18)
head(team)
```

```{r}
#| label: mutating-a-specific-team
#| message: false
#| warning: true
#| paged-print : false

library(tidyverse)
team <- team %>%
  mutate(
    Team = "Lakers",
    Won_award = ifelse(is.na(Awards), "0", "1")
  )
head(team)
```

```{r}
#| label: mutating-a-specific-team-with-stats
#| message: false
#| warning: true
#| paged-print : false

library(tidyverse)
team_stat <- team %>% mutate(
  PRA=PTS+TRB+AST,
  STOCKS=STL+BLK) %>% dplyr::select("MP", "PRA", "STOCKS")
head(team_stat)
```

## Creating A Function

```{r}
#| label: creating-a-function
#| message: false
#| warning: true
#| paged-print: false

all_nba <- function(x){
  team_inside <- read_excel("data/NBA Team Total Data 2024-2025.xlsx", sheet = x)
  team_inside <- team_inside %>%
  mutate(
    Team = x,
    Won_award = ifelse(is.na(Awards), "0", "1"),
    PRA=PTS+TRB+AST,
    STOCKS=STL+BLK) 
  print(team_inside)
}
```

```{r}
#| label: loading-another-dataset-with-team-info
#| message: false
#| warning: true
#| paged-print : false

library(readxl)
team_info <- excel_sheets("data/NBA Team Total Data 2024-2025.xlsx")
head(team_info)
```

```{r include=FALSE}
all_stats <- lapply(team_info, all_nba) %>% bind_rows()
```

```{r}
head(all_stats)
```

## Adding Conference Information

```{r}
conf <- read_excel("data/Team Conferences.xlsx")
head(conf)
```

```{r}
all_stats <- all_stats %>%
  left_join(conf, by = "Team") %>%
  mutate(
    Conference_binary = if_else(Conference == "East", 1, 0)
  )
```

## Visual Exploration

```{r}
#| label: fig-PRA-and-STOCKS-by-conference
#| message: false
#| warning: true
#| fig-cap: This graph shows PRA and STOCKS stats from eastern and western conference teams.
#| fig-alt: This graph shows PRA and STOCKS stats from eastern and western conference teams.
#| paged-print : false


ggplot(all_stats, aes(x = PRA, y = STOCKS, color = Conference)) +
  geom_point(alpha = 0.7) +
  labs(
    title = "PRA vs. STOCKS by Conference",
    x = "Points + Rebounds + Assists (PRA)",
    y = "Steals + Blocks (STOCKS)",
    color = "Conference"
  ) +
  theme_minimal()
```

```{r}
#| label: fig-player-PRA-by-conference
#| message: false
#| warning: true
#| fig-cap: This graph shows players' PRA by eastern and western conference.
#| fig-alt: This graph shows players' PRA by eastern and western conference.
#| paged-print : false

ggplot(all_stats, aes(x = PRA, fill = Conference)) +
  geom_histogram(position = "identity", alpha = 0.5, bins = 30) +
  labs(
    title = "Distribution of PRA by Conference",
    x = "PRA",
    y = "Count of Players",
    fill = "Conference"
  ) +
  theme_minimal()
```

## Correlation Analysis

```{r}
cor.test(all_stats$Conference_binary, all_stats$STOCKS, method = "pearson")
cor.test(all_stats$Conference_binary, all_stats$PRA, method = "pearson")
```

```{r}
#| label: loading-libraries-for-analysis (1)
#| message: false
#| warning: true
#| paged-print : false

library(ggcorrplot)
vars <- all_stats %>% dplyr::select("Age", "PRA", "STOCKS")
cm <- round(cor(vars, use = "pairwise.complete.obs"), 3)
ggcorrplot(cm, lab = TRUE, hc.order = FALSE, type = "lower")
```

```{r}
#| label: loading-libraries-for-analysis (2)
#| message: false
#| warning: true
#| paged-print : false

library(ppcor)
colnames(all_stats)
pcor.test(all_stats$PRA, all_stats$STOCKS, all_stats$Age, method = "pearson")
```

## Communicate Your Findings

I have no idea what's going on with my functions! I can't plot nor read the graphs to come to a conclusion.! (In retrospect, this was a really fun assignment.) These were my initial thoughts and challengers encounters when I first submitted this assignment. After I was giving some time to personally work on it, I was able to make sure that the codes ran perfectly with some much needed assistance. Look out for a much more polish version in the next few weeks!
